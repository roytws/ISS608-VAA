{
  "hash": "73616bfb5c15d177493d2c28dd081d2e",
  "result": {
    "markdown": "---\ntitle: \"Take-Home_EX03\"\nauthor: \"Teo Wee Siang Roy\"\ndate: \"June 11, 2025\"\ndate-modified: \"last-modified\"\nformat:\n  html:\n    toc: true\n    theme: default\n    code-fold: show\n\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\nfreeze: true\n---\n\n\n\n# Take-Home 3\n\nReplicate Take home 2 with teammates's package and Data Cleaning/Wrangling. \n\n# Set-up\n\n## Import library package\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, jsonlite, lubridate, ggraph, tidygraph, visNetwork, igraph, patchwork)\n```\n:::\n\n\n## Import data and extract nodes and edges\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load graph structure\nMC3 <- fromJSON(\"TH03/data/MC3_graph.json\")\nMC3_schema <- fromJSON(\"TH03/data/MC3_schema.json\")\n\nmc3_nodes <- as_tibble(MC3$nodes)\nmc3_edges <- as_tibble(MC3$edges)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(MC3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 5\n $ directed  : logi TRUE\n $ multigraph: logi FALSE\n $ graph     :List of 4\n  ..$ mode        : chr \"static\"\n  ..$ edge_default: Named list()\n  ..$ node_default: Named list()\n  ..$ name        : chr \"VAST_MC3_Knowledge_Graph\"\n $ nodes     :'data.frame':\t1159 obs. of  31 variables:\n  ..$ type             : chr [1:1159] \"Entity\" \"Entity\" \"Entity\" \"Entity\" ...\n  ..$ label            : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ name             : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ sub_type         : chr [1:1159] \"Person\" \"Person\" \"Person\" \"Person\" ...\n  ..$ id               : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ timestamp        : chr [1:1159] NA NA NA NA ...\n  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...\n  ..$ findings         : chr [1:1159] NA NA NA NA ...\n  ..$ content          : chr [1:1159] NA NA NA NA ...\n  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...\n  ..$ results          : chr [1:1159] NA NA NA NA ...\n  ..$ movement_type    : chr [1:1159] NA NA NA NA ...\n  ..$ destination      : chr [1:1159] NA NA NA NA ...\n  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...\n  ..$ outcome          : chr [1:1159] NA NA NA NA ...\n  ..$ activity_type    : chr [1:1159] NA NA NA NA ...\n  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...\n  ..$ thing_collected  :'data.frame':\t1159 obs. of  2 variables:\n  .. ..$ type: chr [1:1159] NA NA NA NA ...\n  .. ..$ name: chr [1:1159] NA NA NA NA ...\n  ..$ reference        : chr [1:1159] NA NA NA NA ...\n  ..$ date             : chr [1:1159] NA NA NA NA ...\n  ..$ time             : chr [1:1159] NA NA NA NA ...\n  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...\n  ..$ permission_type  : chr [1:1159] NA NA NA NA ...\n  ..$ start_date       : chr [1:1159] NA NA NA NA ...\n  ..$ end_date         : chr [1:1159] NA NA NA NA ...\n  ..$ report_type      : chr [1:1159] NA NA NA NA ...\n  ..$ submission_date  : chr [1:1159] NA NA NA NA ...\n  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...\n  ..$ authority_level  : chr [1:1159] NA NA NA NA ...\n  ..$ coordination_type: chr [1:1159] NA NA NA NA ...\n  ..$ operational_role : chr [1:1159] NA NA NA NA ...\n $ edges     :'data.frame':\t3226 obs. of  5 variables:\n  ..$ id         : chr [1:3226] \"2\" \"3\" \"5\" \"3013\" ...\n  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...\n  ..$ source     : chr [1:3226] \"Sam\" \"Sam\" \"Sam\" \"Sam\" ...\n  ..$ target     : chr [1:3226] \"Relationship_Suspicious_217\" \"Event_Communication_370\" \"Event_Assessment_600\" \"Relationship_Colleagues_430\" ...\n  ..$ type       : chr [1:3226] NA \"sent\" NA NA ...\n```\n:::\n:::\n\n## Clean and Wrangling nodes \n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_nodes_cleaned <- mc3_nodes %>%\n  mutate(id = as.character(id)) %>%\n  filter(!is.na(id)) %>%\n  distinct(id, .keep_all = TRUE) %>%\n  select(-thing_collected)\n\nmc3_edges_cleaned <- mc3_edges %>%\n  rename(from_id = source, \n         to_id = target) %>%\n  mutate(across(c(from_id, to_id), as.character)) %>%\n  filter(from_id %in% mc3_nodes_cleaned$id, \n         to_id %in% mc3_nodes_cleaned$id) %>%\n  filter(!is.na(from_id), !is.na(to_id))\n\nnode_index_lookup <- mc3_nodes_cleaned %>%\n  mutate(.row_id = row_number()) %>%\n  select(id, .row_id)\n\nmc3_edges_indexed <- mc3_edges_cleaned %>%\n  left_join(node_index_lookup, by = c(\"from_id\" = \"id\")) %>%\n  rename(from = .row_id) %>%\n  left_join(node_index_lookup, by = c(\"to_id\" = \"id\")) %>%\n  rename(to = .row_id) %>%\n  select(from, to, is_inferred, type) %>%\n  filter(!is.na(from) & !is.na(to))\n\nused_node_indices <- sort(unique(c(mc3_edges_indexed$from, mc3_edges_indexed$to)))\n\nmc3_nodes_final <- mc3_nodes_cleaned %>%\n  slice(used_node_indices) %>%\n  mutate(new_index = row_number())\n\nold_to_new_index <- tibble(\n  old_index = used_node_indices,\n  new_index = seq_along(used_node_indices)\n)\n\nmc3_edges_final <- mc3_edges_indexed %>%\n  left_join(old_to_new_index, by = c(\"from\" = \"old_index\")) %>%\n  rename(from_new = new_index) %>%\n  left_join(old_to_new_index, by = c(\"to\" = \"old_index\")) %>%\n  rename(to_new = new_index) %>%\n  select(from = from_new, to = to_new, is_inferred, type)\n```\n:::\n\n\n##  Entity Network Construction\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter People and Vessels\nentity_nodes <- mc3_nodes_final %>%\n  filter(type == \"Entity\", sub_type %in% c(\"Person\", \"Vessel\")) %>%\n  select(id, name, sub_type)\n\n# Assign groups\nentity_nodes <- entity_nodes %>%\n  mutate(\n    group = case_when(\n      name %in% c(\"Green Guardians\", \"Reef Guardian\", \"EcoVigil\", \"Sentinel\") ~ \"Environmentalism\",\n      name %in% c(\"Sailor Shift\", \"Sailor Shifts Team\") ~ \"Sailor Shift\",\n      name %in% c(\"Mariners Dream\", \"Marlin\", \"Recreational Fishing Boats\") ~ \"Fishing/Leisure\",\n      name %in% c(\"Serenity\", \"Horizon\", \"Osprey\", \"Remora\", \"Neptune\", \"Mako\") ~ \"Tourism/Leisure\",\n      name %in% c(\"Boss\", \"Mrs. Money\", \"The Middleman\") ~ \"Suspicious\",\n      TRUE ~ sub_type\n    )\n  )\n\n# Build communication pairs\nvalid_ids <- entity_nodes$id\ncomm_event_ids <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  pull(id)\n\nedge_lookup <- tibble(\n  index = mc3_nodes_final$new_index,\n  id = mc3_nodes_final$id\n)\n\nmc3_edges_for_events <- mc3_edges_final %>%\n  left_join(edge_lookup, by = c(\"from\" = \"index\")) %>%\n  rename(from_id = id) %>%\n  left_join(edge_lookup, by = c(\"to\" = \"index\")) %>%\n  rename(to_id = id)\n\nsent_edges <- mc3_edges_for_events %>%\n  filter(type == \"sent\", to_id %in% comm_event_ids) %>%\n  select(event_id = to_id, entity_id = from_id)\n\nreceived_edges <- mc3_edges_for_events %>%\n  filter(type == \"received\", from_id %in% comm_event_ids) %>%\n  select(event_id = from_id, entity_id = to_id)\n\nentity_event_edges <- bind_rows(sent_edges, received_edges)\n\nentity_pairs <- entity_event_edges %>%\n  inner_join(entity_event_edges, by = \"event_id\") %>%\n  filter(entity_id.x != entity_id.y) %>%\n  distinct(entity_id.x, entity_id.y) %>%\n  rename(source = entity_id.x, target = entity_id.y) %>%\n  filter(source %in% valid_ids & target %in% valid_ids)\n\n# Build tidygraph\ngraph_tbl <- tbl_graph(nodes = entity_nodes, edges = entity_pairs, directed = FALSE)\n```\n:::\n\n\n# Cluster Analysis\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert to igraph\ngraph_igraph <- as.igraph(graph_tbl)\n\n# Run clustering algorithms\ncluster_infomap <- cluster_infomap(graph_igraph)\ncluster_louvain <- cluster_louvain(graph_igraph)\ncluster_walktrap <- cluster_walktrap(graph_igraph, steps = 10)\ncluster_edge_betweenness <- cluster_edge_betweenness(graph_igraph, directed = FALSE)\n\n# Handle spinglass for disconnected components\nif (!is_connected(graph_igraph)) {\n  comp_info <- components(graph_igraph)\n  largest_comp <- which.max(comp_info$csize)\n  node_indices <- which(comp_info$membership == largest_comp)\n  graph_connected <- induced_subgraph(graph_igraph, node_indices)\n  cluster_spinglass <- cluster_spinglass(graph_connected)\n  \n  spinglass_vec <- rep(NA, vcount(graph_igraph))\n  spinglass_vec[node_indices] <- membership(cluster_spinglass)\n} else {\n  cluster_spinglass <- cluster_spinglass(graph_igraph)\n  spinglass_vec <- membership(cluster_spinglass)\n}\n\n# Add cluster assignments to entity_nodes\nentity_nodes <- entity_nodes %>%\n  mutate(\n    infomap_cluster = as.factor(membership(cluster_infomap)),\n    louvain_cluster = as.factor(membership(cluster_louvain)),\n    walktrap_cluster = as.factor(membership(cluster_walktrap)),\n    edge_betweenness_cluster = as.factor(membership(cluster_edge_betweenness)),\n    spinglass_cluster = as.factor(spinglass_vec)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create performance metrics\ncluster_metrics <- tibble(\n  Algorithm = c(\"Infomap\", \"Louvain\", \"Walktrap\", \"Edge Betweenness\", \"Spinglass\"),\n  Clusters = c(\n    length(unique(membership(cluster_infomap))),\n    length(unique(membership(cluster_louvain))),\n    length(unique(membership(cluster_walktrap))),\n    length(unique(membership(cluster_edge_betweenness))),\n    length(unique(membership(cluster_spinglass)))\n  ),\n  Modularity = c(\n    modularity(cluster_infomap),\n    modularity(cluster_louvain),\n    modularity(cluster_walktrap),\n    modularity(cluster_edge_betweenness),\n    modularity(cluster_spinglass)\n  )\n)\n\n# Split algorithms by performance\nhigh_modularity <- cluster_metrics %>%\n  filter(Modularity >= 0.3) %>%\n  arrange(desc(Modularity))\n\nlow_modularity <- cluster_metrics %>%\n  filter(Modularity < 0.3) %>%\n  arrange(desc(Modularity))\n\nprint(\"High Performance Algorithms (Modularity >= 0.3):\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"High Performance Algorithms (Modularity >= 0.3):\"\n```\n:::\n\n```{.r .cell-code}\nprint(high_modularity)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  Algorithm        Clusters Modularity\n  <chr>               <int>      <dbl>\n1 Edge Betweenness       10      0.342\n2 Louvain                 7      0.341\n3 Walktrap                7      0.304\n```\n:::\n\n```{.r .cell-code}\nprint(\"Low Performance Algorithms (Modularity < 0.3):\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Low Performance Algorithms (Modularity < 0.3):\"\n```\n:::\n\n```{.r .cell-code}\nprint(low_modularity)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 3\n  Algorithm Clusters Modularity\n  <chr>        <int>      <dbl>\n1 Spinglass        4      0.236\n2 Infomap         15      0.143\n```\n:::\n:::\n\n\n## Prepare Visualisation data\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create edges for visualization\nnode_id_map <- graph_tbl %>% \n  activate(nodes) %>% \n  as_tibble() %>% \n  mutate(node_index = row_number()) %>% \n  select(node_index, id)\n\nedges_vis <- graph_tbl %>%\n  activate(edges) %>% \n  as_tibble() %>%\n  left_join(node_id_map, by = c(\"from\" = \"node_index\")) %>%\n  rename(from_id = id) %>%\n  left_join(node_id_map, by = c(\"to\" = \"node_index\")) %>%\n  rename(to_id = id) %>%\n  select(from = from_id, to = to_id)\n```\n:::\n\n\n## Interactive Network Visualisation\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create nodes for Louvain (Best Algorithm) - ASCENDING ORDER\nnodes_vis_louvain <- entity_nodes %>%\n  mutate(\n    id = as.character(id),\n    label = name,\n    group = factor(louvain_cluster, levels = sort(as.numeric(unique(louvain_cluster)))),\n    shape = ifelse(sub_type == \"Person\", \"dot\", \"triangle\"),\n    title = paste0(\n      \"<div style='color:white;'>\",\n      \"<b>\", name, \"</b><br>\",\n      \"Type: \", sub_type, \"<br>\",\n      \"Louvain Cluster: \", louvain_cluster,\n      \"</div>\"\n    )\n  ) %>%\n  select(id, label, group, shape, title)\n\n# Create nodes for Infomap (Comparison) - ASCENDING ORDER\nnodes_vis_infomap <- entity_nodes %>%\n  mutate(\n    id = as.character(id),\n    label = name,\n    group = factor(infomap_cluster, levels = sort(as.numeric(unique(infomap_cluster)))), \n    shape = ifelse(sub_type == \"Person\", \"dot\", \"triangle\"),\n    title = paste0(\n      \"<div style='color:white;'>\",\n      \"<b>\", name, \"</b><br>\",\n      \"Type: \", sub_type, \"<br>\",\n      \"Infomap Cluster: \", infomap_cluster,\n      \"</div>\"\n    )\n  ) %>%\n  select(id, label, group, shape, title)\nprint(\"🥇 Louvain Clustering - Best Performance (Modularity: 0.359)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"🥇 Louvain Clustering - Best Performance (Modularity: 0.359)\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Louvain Interactive Network - ORDERED DROPDOWN\n\nvis_louvain <- visNetwork(nodes_vis_louvain, edges_vis, width = \"100%\", height = \"600px\") %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visNodes(font = list(size = 16)) %>%\n  visEdges(color = list(color = \"rgba(150,150,150,0.3)\")) %>%\n  visInteraction(\n    tooltipStyle = 'background-color: black; color: white; border-radius: 5px; padding: 8px;'\n  ) %>%\n  visOptions(\n    highlightNearest = TRUE, \n    selectedBy = list(variable = \"group\", main = \"Select Cluster:\", sort = TRUE)\n  ) %>%\n  visLegend(position = \"right\", main = \"Louvain Clusters (Optimal)\")\n\nvis_louvain\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-7a3447244eed433b3b1a\" style=\"width:100%;height:600px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7a3447244eed433b3b1a\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Sailor Shift\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"Mariner's Dream\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Sailor Shift\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"Mariner's Dream\"],\"group\":[\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"3\",\"4\",\"5\",\"5\",\"1\",\"1\",\"3\",\"3\",\"3\",\"3\",\"2\",\"2\",\"2\",\"2\",\"2\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"1\",\"6\",\"2\",\"2\",\"7\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"title\":[\"<div style='color:white;'><b>Sam<\\/b><br>Type: Person<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Kelly<\\/b><br>Type: Person<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Nadia Conti<\\/b><br>Type: Person<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Elise<\\/b><br>Type: Person<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Liam Thorne<\\/b><br>Type: Person<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Samantha Blake<\\/b><br>Type: Person<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Davis<\\/b><br>Type: Person<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Rodriguez<\\/b><br>Type: Person<br>Louvain Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Sailor Shift<\\/b><br>Type: Person<br>Louvain Cluster: 4<\\/div>\",\"<div style='color:white;'><b>Clepper Jensen<\\/b><br>Type: Person<br>Louvain Cluster: 5<\\/div>\",\"<div style='color:white;'><b>Miranda Jordan<\\/b><br>Type: Person<br>Louvain Cluster: 5<\\/div>\",\"<div style='color:white;'><b>The Intern<\\/b><br>Type: Person<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>The Lookout<\\/b><br>Type: Person<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>The Accountant<\\/b><br>Type: Person<br>Louvain Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Mrs. Money<\\/b><br>Type: Person<br>Louvain Cluster: 3<\\/div>\",\"<div style='color:white;'><b>The Middleman<\\/b><br>Type: Person<br>Louvain Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Boss<\\/b><br>Type: Person<br>Louvain Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Small Fry<\\/b><br>Type: Person<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Neptune<\\/b><br>Type: Vessel<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Marlin<\\/b><br>Type: Vessel<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Serenity<\\/b><br>Type: Vessel<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Mako<\\/b><br>Type: Vessel<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Reef Guardian<\\/b><br>Type: Vessel<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Horizon<\\/b><br>Type: Vessel<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Seawatch<\\/b><br>Type: Vessel<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>EcoVigil<\\/b><br>Type: Vessel<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Sentinel<\\/b><br>Type: Vessel<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Osprey<\\/b><br>Type: Vessel<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Defender<\\/b><br>Type: Vessel<br>Louvain Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Northern Light<\\/b><br>Type: Vessel<br>Louvain Cluster: 6<\\/div>\",\"<div style='color:white;'><b>Remora<\\/b><br>Type: Vessel<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Knowles<\\/b><br>Type: Vessel<br>Louvain Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Mariner's Dream<\\/b><br>Type: Vessel<br>Louvain Cluster: 7<\\/div>\"],\"x\":[0.3643582930311668,0.5552100767705679,-0.3187926289221983,-0.1665221775578917,0.00058635823052966,-0.9398965992261692,-0.5323971131696854,-0.3841832990002255,0.9667531919455865,-0.2208278127260441,-0.02792277713975477,0.1876593326252725,0.07328513984247076,-0.02859038610692455,-0.1785963830535389,0.01692147298174862,-0.2205005046233763,-0.7138291524752955,-0.3787262686979765,-0.5820649364919047,-0.5620827493511253,-0.4945895940238341,-0.32390202801933,-0.1785447436541575,-0.294928691109369,-0.01907870830330305,-0.1945823220921725,-0.8709012830591734,-0.5149812425915709,1,-0.4902019454692794,-0.8193737251135647,-1],\"y\":[0.3331495999427896,0.5044933170723476,-0.4487487789679028,-0.37498266690721,-0.5317713098841759,-0.2610875269349126,-0.5948373000003798,-0.7244385959355781,-0.5337360209911315,1,0.9871404852726777,-0.2622070063965926,0.07353114545450912,-1,-0.5321479683498469,-0.7932040369106176,-0.706061846700947,-0.6082224477485172,-0.3262907759147885,-0.256648843213277,-0.07214130255999895,-0.2940095217411766,-0.04150919159982769,0.03733013823806841,0.206318925364269,-0.1607817283792041,-0.09039972919672334,-0.06120972182962781,0.1192009530632923,0.06566224742398319,-0.5057738599266725,-0.4984102488461214,0.7718388380320318]},\"edges\":{\"from\":[\"Sam\",\"Sam\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Elise\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Davis\",\"Nadia Conti\",\"Davis\",\"Davis\",\"Rodriguez\",\"Davis\",\"Rodriguez\",\"Nadia Conti\",\"Rodriguez\",\"Clepper Jensen\",\"Clepper Jensen\",\"The Intern\",\"The Intern\",\"The Intern\",\"Sam\",\"The Lookout\",\"The Lookout\",\"The Lookout\",\"The Accountant\",\"The Accountant\",\"Mrs. Money\",\"Mrs. Money\",\"The Intern\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"The Middleman\",\"Mrs. Money\",\"Liam Thorne\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Small Fry\",\"Davis\",\"Neptune\",\"Neptune\",\"Neptune\",\"Elise\",\"Neptune\",\"Nadia Conti\",\"Davis\",\"Marlin\",\"Marlin\",\"Marlin\",\"Serenity\",\"Serenity\",\"Neptune\",\"Serenity\",\"Mako\",\"Marlin\",\"Mako\",\"Mako\",\"Mako\",\"Davis\",\"Boss\",\"Samantha Blake\",\"Neptune\",\"Elise\",\"Serenity\",\"Reef Guardian\",\"Mako\",\"Marlin\",\"Reef Guardian\",\"Reef Guardian\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Horizon\",\"Horizon\",\"Mako\",\"Horizon\",\"Reef Guardian\",\"Reef Guardian\",\"Horizon\",\"Reef Guardian\",\"Liam Thorne\",\"EcoVigil\",\"Horizon\",\"Mako\",\"Reef Guardian\",\"Nadia Conti\",\"Seawatch\",\"Mako\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"Rodriguez\",\"Mako\",\"Neptune\",\"Davis\",\"Nadia Conti\",\"Mako\",\"Davis\",\"Sam\",\"Marlin\",\"Small Fry\",\"Small Fry\",\"Seawatch\",\"The Lookout\",\"Rodriguez\",\"Davis\",\"Mako\",\"Elise\",\"Mrs. Money\",\"Elise\",\"Mrs. Money\",\"Liam Thorne\",\"Nadia Conti\",\"Nadia Conti\",\"Mrs. Money\",\"Rodriguez\",\"Nadia Conti\",\"The Lookout\",\"Horizon\",\"Nadia Conti\",\"The Accountant\",\"Liam Thorne\",\"The Lookout\",\"Nadia Conti\",\"Davis\",\"Nadia Conti\",\"Davis\",\"Seawatch\",\"EcoVigil\",\"Mako\",\"Mako\",\"Davis\"],\"to\":[\"Kelly\",\"Kelly\",\"Liam Thorne\",\"Neptune\",\"Marlin\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Boss\",\"EcoVigil\",\"Mako\",\"Mako\",\"Remora\",\"Davis\",\"Neptune\",\"Boss\",\"Boss\",\"Rodriguez\",\"Mrs. Money\",\"Rodriguez\",\"Remora\",\"Miranda Jordan\",\"Miranda Jordan\",\"The Lookout\",\"Mrs. Money\",\"The Lookout\",\"The Lookout\",\"Sentinel\",\"Horizon\",\"Reef Guardian\",\"Boss\",\"The Middleman\",\"Boss\",\"The Middleman\",\"Mrs. Money\",\"Neptune\",\"Mako\",\"Remora\",\"Boss\",\"The Middleman\",\"The Middleman\",\"The Middleman\",\"Boss\",\"Boss\",\"Mako\",\"Mako\",\"Remora\",\"Small Fry\",\"Mako\",\"Serenity\",\"Remora\",\"Neptune\",\"Reef Guardian\",\"Neptune\",\"Neptune\",\"Mako\",\"Remora\",\"Reef Guardian\",\"Mako\",\"Reef Guardian\",\"Serenity\",\"Mako\",\"Remora\",\"Mako\",\"Osprey\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Reef Guardian\",\"Defender\",\"Reef Guardian\",\"Reef Guardian\",\"Horizon\",\"Sentinel\",\"Reef Guardian\",\"EcoVigil\",\"Seawatch\",\"Sentinel\",\"EcoVigil\",\"Horizon\",\"Seawatch\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Osprey\",\"Defender\",\"Defender\",\"Defender\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Knowles\",\"Knowles\",\"The Lookout\",\"Remora\",\"Mako\",\"Remora\",\"Defender\",\"Sentinel\",\"Boss\",\"Rodriguez\",\"Horizon\",\"Neptune\",\"Neptune\",\"Mako\",\"Mako\",\"The Middleman\",\"Davis\",\"Elise\",\"Remora\",\"Mrs. Money\",\"Marlin\",\"Horizon\",\"Seawatch\",\"Sentinel\",\"Boss\",\"Boss\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"Remora\",\"Boss\",\"Sentinel\",\"Sentinel\",\"Knowles\",\"Defender\",\"Knowles\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false,\"font\":{\"size\":16}},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false,\"color\":{\"color\":\"rgba(150,150,150,0.3)\"}},\"physics\":{\"stabilization\":false},\"interaction\":{\"zoomSpeed\":1}},\"groups\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"],\"width\":\"100%\",\"height\":\"600px\",\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false,\"variable\":\"group\",\"main\":\"Select Cluster:\",\"values\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\"]},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"tooltipStay\":300,\"tooltipStyle\":\"background-color: black; color: white; border-radius: 5px; padding: 8px;\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"main\":{\"text\":\"Louvain Clusters (Optimal)\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:14px;text-align:center;\"}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Infomap Interactive Network - ORDERED DROPDOWN\nprint(\"📊 Infomap Clustering - High Granularity (13 clusters)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"📊 Infomap Clustering - High Granularity (13 clusters)\"\n```\n:::\n\n```{.r .cell-code}\nvis_infomap <- visNetwork(nodes_vis_infomap, edges_vis, width = \"100%\", height = \"600px\") %>%\n  visIgraphLayout(layout = \"layout_with_fr\") %>%\n  visNodes(font = list(size = 16)) %>%\n  visEdges(color = list(color = \"rgba(150,150,150,0.3)\")) %>%\n  visInteraction(\n    tooltipStyle = 'background-color: black; color: white; border-radius: 5px; padding: 8px;'\n  ) %>%\n  visOptions(\n    highlightNearest = TRUE, \n    selectedBy = list(variable = \"group\", main = \"Select Cluster:\", sort = TRUE) \n  ) %>%\n  visLegend(position = \"right\", main = \"Infomap Clusters\")\n\nvis_infomap\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-3778487486882c62b2b1\" style=\"width:100%;height:600px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3778487486882c62b2b1\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Sailor Shift\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"Mariner's Dream\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Sailor Shift\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"Mariner's Dream\"],\"group\":[\"1\",\"1\",\"2\",\"3\",\"4\",\"3\",\"5\",\"2\",\"6\",\"7\",\"7\",\"8\",\"9\",\"10\",\"8\",\"4\",\"10\",\"5\",\"11\",\"3\",\"12\",\"3\",\"12\",\"13\",\"13\",\"12\",\"9\",\"3\",\"3\",\"14\",\"11\",\"5\",\"15\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"title\":[\"<div style='color:white;'><b>Sam<\\/b><br>Type: Person<br>Infomap Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Kelly<\\/b><br>Type: Person<br>Infomap Cluster: 1<\\/div>\",\"<div style='color:white;'><b>Nadia Conti<\\/b><br>Type: Person<br>Infomap Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Elise<\\/b><br>Type: Person<br>Infomap Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Liam Thorne<\\/b><br>Type: Person<br>Infomap Cluster: 4<\\/div>\",\"<div style='color:white;'><b>Samantha Blake<\\/b><br>Type: Person<br>Infomap Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Davis<\\/b><br>Type: Person<br>Infomap Cluster: 5<\\/div>\",\"<div style='color:white;'><b>Rodriguez<\\/b><br>Type: Person<br>Infomap Cluster: 2<\\/div>\",\"<div style='color:white;'><b>Sailor Shift<\\/b><br>Type: Person<br>Infomap Cluster: 6<\\/div>\",\"<div style='color:white;'><b>Clepper Jensen<\\/b><br>Type: Person<br>Infomap Cluster: 7<\\/div>\",\"<div style='color:white;'><b>Miranda Jordan<\\/b><br>Type: Person<br>Infomap Cluster: 7<\\/div>\",\"<div style='color:white;'><b>The Intern<\\/b><br>Type: Person<br>Infomap Cluster: 8<\\/div>\",\"<div style='color:white;'><b>The Lookout<\\/b><br>Type: Person<br>Infomap Cluster: 9<\\/div>\",\"<div style='color:white;'><b>The Accountant<\\/b><br>Type: Person<br>Infomap Cluster: 10<\\/div>\",\"<div style='color:white;'><b>Mrs. Money<\\/b><br>Type: Person<br>Infomap Cluster: 8<\\/div>\",\"<div style='color:white;'><b>The Middleman<\\/b><br>Type: Person<br>Infomap Cluster: 4<\\/div>\",\"<div style='color:white;'><b>Boss<\\/b><br>Type: Person<br>Infomap Cluster: 10<\\/div>\",\"<div style='color:white;'><b>Small Fry<\\/b><br>Type: Person<br>Infomap Cluster: 5<\\/div>\",\"<div style='color:white;'><b>Neptune<\\/b><br>Type: Vessel<br>Infomap Cluster: 11<\\/div>\",\"<div style='color:white;'><b>Marlin<\\/b><br>Type: Vessel<br>Infomap Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Serenity<\\/b><br>Type: Vessel<br>Infomap Cluster: 12<\\/div>\",\"<div style='color:white;'><b>Mako<\\/b><br>Type: Vessel<br>Infomap Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Reef Guardian<\\/b><br>Type: Vessel<br>Infomap Cluster: 12<\\/div>\",\"<div style='color:white;'><b>Horizon<\\/b><br>Type: Vessel<br>Infomap Cluster: 13<\\/div>\",\"<div style='color:white;'><b>Seawatch<\\/b><br>Type: Vessel<br>Infomap Cluster: 13<\\/div>\",\"<div style='color:white;'><b>EcoVigil<\\/b><br>Type: Vessel<br>Infomap Cluster: 12<\\/div>\",\"<div style='color:white;'><b>Sentinel<\\/b><br>Type: Vessel<br>Infomap Cluster: 9<\\/div>\",\"<div style='color:white;'><b>Osprey<\\/b><br>Type: Vessel<br>Infomap Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Defender<\\/b><br>Type: Vessel<br>Infomap Cluster: 3<\\/div>\",\"<div style='color:white;'><b>Northern Light<\\/b><br>Type: Vessel<br>Infomap Cluster: 14<\\/div>\",\"<div style='color:white;'><b>Remora<\\/b><br>Type: Vessel<br>Infomap Cluster: 11<\\/div>\",\"<div style='color:white;'><b>Knowles<\\/b><br>Type: Vessel<br>Infomap Cluster: 5<\\/div>\",\"<div style='color:white;'><b>Mariner's Dream<\\/b><br>Type: Vessel<br>Infomap Cluster: 15<\\/div>\"],\"x\":[0.03084592329599367,-0.09614946985803607,0.3982604001687606,0.4150574251594388,0.6300581460876191,-0.1915499735680888,0.42594145010762,0.603232537840479,-0.9347360145211333,-0.08626908167576408,0.09043597725415031,0.4947729802245986,0.1537745291092019,1,0.5392516085937251,0.8540617025076254,0.6639548948659586,0.3579426997747166,0.2665679951162261,0.09889186428872665,-0.0422652005220393,0.188999533881355,0.05552750189144562,0.06825375407012801,-0.1330348095136711,0.3126902998809993,0.1673612082801264,-0.0497620106789648,-0.1677036005297082,-1,0.3646129090890595,0.213637766150508,-0.8104892596433321],\"y\":[0.8276112231456896,1,0.02997387463847723,0.1695529607356465,0.2147193871501181,-0.1955046733656639,-0.1862771538754225,-0.1411732428186755,0.4241556183539978,-0.9746387369908023,-1,0.4695752126379391,0.5337299576128511,-0.03838356779379626,0.08711471772271318,0.1006607788450042,-0.02340916390451075,-0.3256757918406624,0.0424013614988441,-0.05930136018628906,0.02922768652008356,-0.0311382198942034,0.2137326665478869,0.3463444811062395,0.3510979040463442,0.3764221508442407,0.2750588944530641,-0.3341331687319024,0.1556353400104529,-0.0720845222431965,-0.1156212145584383,-0.3557902876098694,-0.5389280358226872]},\"edges\":{\"from\":[\"Sam\",\"Sam\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Elise\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Davis\",\"Nadia Conti\",\"Davis\",\"Davis\",\"Rodriguez\",\"Davis\",\"Rodriguez\",\"Nadia Conti\",\"Rodriguez\",\"Clepper Jensen\",\"Clepper Jensen\",\"The Intern\",\"The Intern\",\"The Intern\",\"Sam\",\"The Lookout\",\"The Lookout\",\"The Lookout\",\"The Accountant\",\"The Accountant\",\"Mrs. Money\",\"Mrs. Money\",\"The Intern\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"The Middleman\",\"Mrs. Money\",\"Liam Thorne\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Small Fry\",\"Davis\",\"Neptune\",\"Neptune\",\"Neptune\",\"Elise\",\"Neptune\",\"Nadia Conti\",\"Davis\",\"Marlin\",\"Marlin\",\"Marlin\",\"Serenity\",\"Serenity\",\"Neptune\",\"Serenity\",\"Mako\",\"Marlin\",\"Mako\",\"Mako\",\"Mako\",\"Davis\",\"Boss\",\"Samantha Blake\",\"Neptune\",\"Elise\",\"Serenity\",\"Reef Guardian\",\"Mako\",\"Marlin\",\"Reef Guardian\",\"Reef Guardian\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Horizon\",\"Horizon\",\"Mako\",\"Horizon\",\"Reef Guardian\",\"Reef Guardian\",\"Horizon\",\"Reef Guardian\",\"Liam Thorne\",\"EcoVigil\",\"Horizon\",\"Mako\",\"Reef Guardian\",\"Nadia Conti\",\"Seawatch\",\"Mako\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"Rodriguez\",\"Mako\",\"Neptune\",\"Davis\",\"Nadia Conti\",\"Mako\",\"Davis\",\"Sam\",\"Marlin\",\"Small Fry\",\"Small Fry\",\"Seawatch\",\"The Lookout\",\"Rodriguez\",\"Davis\",\"Mako\",\"Elise\",\"Mrs. Money\",\"Elise\",\"Mrs. Money\",\"Liam Thorne\",\"Nadia Conti\",\"Nadia Conti\",\"Mrs. Money\",\"Rodriguez\",\"Nadia Conti\",\"The Lookout\",\"Horizon\",\"Nadia Conti\",\"The Accountant\",\"Liam Thorne\",\"The Lookout\",\"Nadia Conti\",\"Davis\",\"Nadia Conti\",\"Davis\",\"Seawatch\",\"EcoVigil\",\"Mako\",\"Mako\",\"Davis\"],\"to\":[\"Kelly\",\"Kelly\",\"Liam Thorne\",\"Neptune\",\"Marlin\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Boss\",\"EcoVigil\",\"Mako\",\"Mako\",\"Remora\",\"Davis\",\"Neptune\",\"Boss\",\"Boss\",\"Rodriguez\",\"Mrs. Money\",\"Rodriguez\",\"Remora\",\"Miranda Jordan\",\"Miranda Jordan\",\"The Lookout\",\"Mrs. Money\",\"The Lookout\",\"The Lookout\",\"Sentinel\",\"Horizon\",\"Reef Guardian\",\"Boss\",\"The Middleman\",\"Boss\",\"The Middleman\",\"Mrs. Money\",\"Neptune\",\"Mako\",\"Remora\",\"Boss\",\"The Middleman\",\"The Middleman\",\"The Middleman\",\"Boss\",\"Boss\",\"Mako\",\"Mako\",\"Remora\",\"Small Fry\",\"Mako\",\"Serenity\",\"Remora\",\"Neptune\",\"Reef Guardian\",\"Neptune\",\"Neptune\",\"Mako\",\"Remora\",\"Reef Guardian\",\"Mako\",\"Reef Guardian\",\"Serenity\",\"Mako\",\"Remora\",\"Mako\",\"Osprey\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Reef Guardian\",\"Defender\",\"Reef Guardian\",\"Reef Guardian\",\"Horizon\",\"Sentinel\",\"Reef Guardian\",\"EcoVigil\",\"Seawatch\",\"Sentinel\",\"EcoVigil\",\"Horizon\",\"Seawatch\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Osprey\",\"Defender\",\"Defender\",\"Defender\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Knowles\",\"Knowles\",\"The Lookout\",\"Remora\",\"Mako\",\"Remora\",\"Defender\",\"Sentinel\",\"Boss\",\"Rodriguez\",\"Horizon\",\"Neptune\",\"Neptune\",\"Mako\",\"Mako\",\"The Middleman\",\"Davis\",\"Elise\",\"Remora\",\"Mrs. Money\",\"Marlin\",\"Horizon\",\"Seawatch\",\"Sentinel\",\"Boss\",\"Boss\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"Remora\",\"Boss\",\"Sentinel\",\"Sentinel\",\"Knowles\",\"Defender\",\"Knowles\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"physics\":false,\"font\":{\"size\":16}},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false,\"color\":{\"color\":\"rgba(150,150,150,0.3)\"}},\"physics\":{\"stabilization\":false},\"interaction\":{\"zoomSpeed\":1}},\"groups\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\"],\"width\":\"100%\",\"height\":\"600px\",\"idselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false,\"variable\":\"group\",\"main\":\"Select Cluster:\",\"values\":[\"1\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"]},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"igraphlayout\":{\"type\":\"square\"},\"tooltipStay\":300,\"tooltipStyle\":\"background-color: black; color: white; border-radius: 5px; padding: 8px;\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"right\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"main\":{\"text\":\"Infomap Clusters\",\"style\":\"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:14px;text-align:center;\"}}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n## Algorithm Comparison visualisation\n\n\n::: {.cell lenght='10' width='8'}\n\n```{.r .cell-code}\n# Clusters comparison\np1 <- ggplot(cluster_metrics, aes(x = reorder(Algorithm, Clusters), y = Clusters, fill = Algorithm)) +\n  geom_col(alpha = 0.8) +\n  geom_text(aes(label = Clusters), vjust = -0.5, size = 3, fontface = \"bold\") +\n  labs(title = \"Number of Clusters by Algorithm\", \n       x = \"Algorithm\", y = \"Number of Clusters\") +\n  theme_minimal() +\n  theme(legend.position = \"none\", axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_brewer(palette = \"Set2\")\n\n# Modularity comparison\np2 <- ggplot(cluster_metrics, aes(x = reorder(Algorithm, -Modularity), y = Modularity, fill = Algorithm)) +\n  geom_col(alpha = 0.8) +\n  geom_text(aes(label = round(Modularity, 3)), vjust = -0.5, size = 3, fontface = \"bold\") +\n  labs(title = \"Modularity Score by Algorithm\", \n       x = \"Algorithm\", y = \"Modularity Score\") +\n  theme_minimal() +\n  theme(legend.position = \"none\", axis.text.x = element_text(angle = 45, hjust = 1)) +\n  scale_fill_brewer(palette = \"Set2\")\n\n# Combined plot\nprint(\"📈 Algorithm Performance Comparison\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"📈 Algorithm Performance Comparison\"\n```\n:::\n\n```{.r .cell-code}\nprint(p1 + p2 + plot_layout(ncol = 2))\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex03_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## interative performance \n\n::: {.cell}\n\n```{.r .cell-code}\n# Create interactive performance table\ncluster_comparison <- function() {\n  performance_table <- cluster_metrics %>%\n    arrange(desc(Modularity)) %>%\n    mutate(\n      Rank = row_number(),\n      Modularity_Score = round(Modularity, 3),\n      Efficiency = case_when(\n        Modularity > 0.35 ~ \"Excellent\",\n        Modularity > 0.25 ~ \"Good\", \n        TRUE ~ \"Fair\"\n      )\n    )\n  \n  DT::datatable(performance_table, \n                options = list(pageLength = 10, dom = 't'),\n                caption = \"🏆 Algorithm Performance Comparison\") %>%\n    DT::formatStyle(\"Efficiency\",\n      backgroundColor = DT::styleEqual(\n        c(\"Excellent\", \"Good\", \"Fair\"),\n        c(\"#d4edda\", \"#fff3cd\", \"#f8d7da\")\n      ))\n}\n\nprint(\"📋 Interactive Performance Analysis\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"📋 Interactive Performance Analysis\"\n```\n:::\n\n```{.r .cell-code}\ncluster_comparison()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-caeeb50748dde899b947\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-caeeb50748dde899b947\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>🏆 Algorithm Performance Comparison<\\/caption>\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\"],[\"Edge Betweenness\",\"Louvain\",\"Walktrap\",\"Spinglass\",\"Infomap\"],[10,7,7,4,15],[0.3416980757786154,0.3411029557627455,0.3040071414401904,0.2358928571428572,0.1432255504860146],[1,2,3,4,5],[0.342,0.341,0.304,0.236,0.143],[\"Good\",\"Good\",\"Good\",\"Fair\",\"Fair\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>Algorithm<\\/th>\\n      <th>Clusters<\\/th>\\n      <th>Modularity<\\/th>\\n      <th>Rank<\\/th>\\n      <th>Modularity_Score<\\/th>\\n      <th>Efficiency<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"dom\":\"t\",\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"Algorithm\",\"targets\":1},{\"name\":\"Clusters\",\"targets\":2},{\"name\":\"Modularity\",\"targets\":3},{\"name\":\"Rank\",\"targets\":4},{\"name\":\"Modularity_Score\",\"targets\":5},{\"name\":\"Efficiency\",\"targets\":6}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"rowCallback\":\"function(row, data, displayNum, displayIndex, dataIndex) {\\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background-color':value == \\\"Excellent\\\" ? \\\"#d4edda\\\" : value == \\\"Good\\\" ? \\\"#fff3cd\\\" : value == \\\"Fair\\\" ? \\\"#f8d7da\\\" : null});\\n}\"}},\"evals\":[\"options.rowCallback\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n",
    "supporting": [
      "Take-Home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\r\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\r\n<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}